<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>添加产品</title>
    <link rel="stylesheet" type="text/css" href="__CSS__/content.css"  />
    <link rel="stylesheet" type="text/css" href="__CSS__/public.css"  />
    <script type="text/javascript" src="__JS__/jquery.js"></script>
    <script type="text/javascript" src="__JS__/jquery.validate.js"></script>
    <script type="text/javascript" src="__JS__/Public.js"></script>
    <script type="text/javascript" src="__JS__/winpop.js"></script>
</head>
<script type="text/javascript">
    // $(document).on('blur','.spp input',function(){
    //     var txt=$(this).parent().find('label').text();
    //     if (txt) {
    //         // console.log(txt);
    //         $(this).attr('value','');
    //         $(this).attr('placeholder',txt);
    //         $(this).parent().find('label').hide();
    //     }
    // })
</script>
<body>
<div id="content">
    <h1>首页 &gt; 产品管理 &gt; 项目管理 &gt;产品详情添加</h1>
    <h2>
        <div class="h2_left">
            <a href="javascript:;" class="add" onclick="javascript:location.href='__APP__/Product/addproduct'">添加</a>
            <a href="javascript:history.back();" class="Retreat">后退</a>
        </div>
    </h2>
    <form action="__APP__/project/project_detail_add/" method="post" onsubmit="return check()" id="add">

        <dl id="cdl" style="display: none;">
            <!--产品分类-->
            <dd>
                <span class="dd_left">项目：</span>
                <span class="dd_right">
                    <select class="select tab_select" name="class_id" style="width: 754px;height: 40px;">
                        <option value="0">选择项目</option>
                        <volist name="clist" id="vo">
                            <option value="{$vo.id}>">{$vo.classname}</option>
                        </volist>
                    </select>
                </span>
            </dd>
        </dl>
        <dl id="cdl" class="aaa" style="margin-top: 0;">
            <!--注册地址-->
            <dd>
                <span class="dd_left">注册地址：</span>
                <span class="dd_right">
                    <input type="hidden" name="class_id[]" value="{$class_id}">
                    <input type="text" style="width: 600px;margin-right: 5px;" class="qtext proname" id="proname" name="det_address[]" value="" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="+" id="jiayitao" class="submit submit2">&nbsp;&nbsp;<input type="button" value="-"  class="submit  jian2 submit2" style="margin-left: 2px;">
                </span>
            </dd>
            <dd>
                <span class="dd_left">地址面积</span>
                <span class="dd_right"><input type="text" name="det_sum[]" class="qtext" value="" style="width:742px;"/></span>
            </dd>
            <!-- 普通注册号 -->
            <dd>
                <span class="dd_left">普通注册号：</span>
                <span class="dd_right">
                    <input type="text" class="qtext num_start" name="det_start[]" style="width:359px;float: left;" value="" />
                    <span style="float: left;line-height: 40px;">～</span>
                    <input type="text" class="qtext num_end" name="det_end[]"  style="width:359px;float: left;" value="" />
                    
                </span>
            </dd>
            <!-- 销售注册号 -->
            <dd>
                <span class="dd_left">销售注册号：</span>
                <span class="dd_right">
                    <input type="text" class="qtext num_start" name="num_start[]" style="width:359px;float: left;" value="" />
                    <span style="float: left;line-height: 40px;">～</span>
                    <input type="text" class="qtext num_end" name="num_end[]"  style="width:359px;float: left;" value="" />
                </span>
            </dd>
            
            <!--大面积房间号-->
            <dd  class="dahao">
                <div>
                    <span class="dd_left">
                        大面积房间号:  
                    </span>
                    <span class="dd_right spp">
                    <input type="text"  class="qtext room_num" name="big_num[0][]" value="" style="width: 265px;" />&nbsp;&nbsp;&nbsp;&nbsp;
                    </span>
                </div>
                <div>
                    <span class="dd_span">面积：</span>
                    <span class="dd_right spp">
                        <input type="text"  class="qtext room_area" name="big_sum[0][]" value="" placeholder="平方米" style="width: 265px;"/>  &nbsp;&nbsp;&nbsp;&nbsp; 
                    </span>
                </div>
                <input type="button" value="+"  class="submit submit2 jia">&nbsp;&nbsp;<input type="button" value="-"  class="submit jian submit2" style="margin-left: 2px;">   
            </dd>

            <!--小面积房间号-->
            <dd class="xiaohao">
                <div>
                    <span class="dd_left">
                        小面积房间号:  
                    </span>
                    <span class="dd_right spp">
                    <input type="text"  class="qtext room_num" name="small_num[0][]" value="" style="width: 265px;" />&nbsp;&nbsp;&nbsp;&nbsp;
                    </span>
                </div>
                <div>
                    <span class="dd_span">面积：</span>
                    <span class="dd_right spp">
                        <input type="text"  class="qtext room_area" name="small_sum[0][]" value="" placeholder="平方米" style="width: 265px;"/>  &nbsp;&nbsp;&nbsp;&nbsp; 
                    </span>
                </div>
                <input type="button" value="+"  class="submit submit2 jia">&nbsp;&nbsp;<input type="button" value="-"  class="submit jian submit2" style="margin-left: 2px;"></span>   
            </dd>
            <!-- 工位 -->
            <dd  class="gong">
                <span class="dd_left">
                    工位:  
                </span>
                <span class="dd_right">
                    <input type="text"  class="qtext room_num" name="det_station[0][]" value="" style="width:600px;" />&nbsp;&nbsp;&nbsp;&nbsp;
                &nbsp;
                </span>
                <input type="button" value="+"  class="submit submit2 jia">&nbsp;&nbsp;<input type="button" value="-"  class="submit jian submit2" style="margin-left: 2px;"> 
                  
            </dd>       
            <!--备注-->
            <dd>
                <span class="dd_left">备注：</span>
                <span class="dd_right">
                    <textarea cols="50" class="text_box" rows="4" class="text_box"  name="detailscoll[]"></textarea>
                </span>
            </dd>
		</dl>
		<dl>
            <dd>
                <input type="submit"  value="提交" class="submit" style="margin-left: 174px;" />
            </dd>
        </dl>
    </form>
</div>
</body>
</html>
<script type="text/javascript">
 /*   $(document).on('click',":submit",function(){
        if($('.select').val()==0){ alert('请选择项目'); return false; }    
    })*/
    // 验证
    function validform(){
        return $("#add").validate({
            rules : {
                'class_id[]' : {required : true},
                'det_sum[]' : { required : true,number:true},
                'det_start[]': { required : true,number:true},
                'det_end[]': { required : true,number:true},
                'num_start[]':{required : true,number:true},
                'num_end[]':{required : true,number:true},
                'big_num[0][]':{required : true,number:true},
                'big_sum[0][]':{required : true,number:true},
                'small_num[0][]':{required : true,number:true},
                'small_sum[0][]':{required : true,number:true},
                'det_station[0][]':{required : true,number:true}

            },
            messages :{
                'class_id[]' : {required : '不能为空'},
                'det_sum[]' : { required : '不能为空',number:"请输入有效的数字"},
                'det_start[]': {required : '不能为空',number:"请输入有效的数字"},
                'det_end[]': {required : '不能为空',number:"请输入有效的数字"},
                'num_start[]':{required : '不能为空',number:"请输入有效的数字"},
                'num_end[]':{required : '不能为空',number:"请输入有效的数字"},
                'big_num[0][]':{required : '不能为空',number:"请输入有效的数字"},
                'big_sum[0][]':{required : '不能为空',number:"请输入有效的数字"},
                'small_num[0][]':{required : '不能为空',number:"请输入有效的数字"},
                'small_sum[0][]':{required : '不能为空',number:"请输入有效的数字"},
                'det_station[0][]':{required : '不能为空',number:"请输入有效的数字"}

            }
        });
    }
    $(document).ready(function(){
        $(validform());
        $(".button").click(function(){
            if(validform().form()) {
                $("#add").submit();
            } else {
            //校验不通过，什么都不用做，校验信息已经正常显示在表单上
            }
        });

    })
    // 按钮加减
	$(document).on('click','.jia',function(){
		var html = $(this).parent().clone();
		$(this).parent().after(html);
        html.find(['class']).each(function(){
            if($(this).attr('class')=='jia'){
                $(this).val('-');
                $(this).attr('class',  'submit jian');
            }
        })
	})
	$(document).on('click','.dahao .jian',function(){
        if ($('.dahao').length > 1) {
            $(this).parent().remove();
        }
	})
    $(document).on('click','.xiaohao .jian',function(){
        if ($('.xiaohao').length > 1) {
            $(this).parent().remove();
        }   
    })
    $(document).on('click','.gong .jian',function(){
        if ($('.gong').length > 1) {
            $(this).parent().remove();
        }   
    })
    $(document).on('click','.jian2',function(){
        if ($('.aaa').length > 1) {
            $(this).parent().parent().parent().remove();
        }
    })
    var q=1;
	$(document).on('click','#jiayitao',function(){

		var html = $(this).parent().parent().parent().clone();      
        // html.attr('class','bbb');
        $(this).parent().parent().parent().after(html);
        $(html).find('[name]').each(function() {
            // alert($(this).attr('name'));
            if($(this).attr('name')=='big_num[0][]'){
                
                $(this).attr('name',  'big_num['+q+'][]')
            }
            if($(this).attr('name')=='big_sum[0][]'){
                $(this).attr('name', 'big_sum['+q+'][]')
            }
            if($(this).attr('name')=='small_num[0][]'){
                
                $(this).attr('name',  'small_num['+q+'][]')
            }
            if($(this).attr('name')=='small_sum[0][]'){
                $(this).attr('name', 'small_sum['+q+'][]')
            }
             if($(this).attr('name')=='det_station[0][]'){
                $(this).attr('name', 'det_station['+q+'][]')
            }
        }); 
        q+=1;
	})
</script>